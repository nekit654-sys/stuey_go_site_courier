# ğŸ—ï¸ ĞĞ Ğ¥Ğ˜Ğ¢Ğ•ĞšĞ¢Ğ£Ğ Ğ Ğ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞ« - Courier Button Site

**Ğ”Ğ°Ñ‚Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ**: 2025-12-15  
**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ**: ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ğ°ÑƒĞ´Ğ¸Ñ‚  

---

## ğŸ“Š ĞĞ‘Ğ©ĞĞ¯ Ğ¡Ğ¢Ğ Ğ£ĞšĞ¢Ğ£Ğ Ğ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Ğ¢ĞĞ§ĞšĞ˜ Ğ’Ğ¥ĞĞ”Ğ ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞ¢Ğ•Ğ›Ğ•Ğ™      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Ğ’ĞµĞ±-ÑĞ°Ğ¹Ñ‚ (React SPA)            â”‚
â”‚  2. Telegram Ğ‘Ğ¾Ñ‚                    â”‚
â”‚  3. ĞĞ´Ğ¼Ğ¸Ğ½-Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    BACKEND CLOUD FUNCTIONS          â”‚
â”‚    (Python 3.11)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ backend/api/                     â”‚
â”‚  â€¢ backend/messenger-api/           â”‚
â”‚  â€¢ backend/telegram-bot/            â”‚
â”‚  â€¢ backend/courier-game/            â”‚
â”‚  â€¢ backend/admin-panel/             â”‚
â”‚  â€¢ backend/admin-finances/          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     PostgreSQL DATABASE              â”‚
â”‚   t_p25272970_courier_button_site   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”— BACKEND Ğ¤Ğ£ĞĞšĞ¦Ğ˜Ğ˜ Ğ˜ Ğ­ĞĞ”ĞŸĞĞ˜ĞĞ¢Ğ«

### 1ï¸âƒ£ **backend/api/index.py** - Ğ“Ğ›ĞĞ’ĞĞ«Ğ™ API
**URL**: `https://functions.poehali.dev/5f6f6889-3ab3-49f0-865b-fcffd245d858`

**ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹ (routes)**:
```python
?route=auth                 # ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ (OAuth Yandex)
?route=referrals            # Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°
?route=couriers             # CRUD ĞºÑƒÑ€ÑŒĞµÑ€Ğ¾Ğ²
?route=profile              # ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
?route=withdrawal           # Ğ—Ğ°ÑĞ²ĞºĞ¸ Ğ½Ğ° Ğ²Ñ‹Ğ¿Ğ»Ğ°Ñ‚Ñ‹
?route=game                 # Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¸Ğ³Ñ€Ñ‹ (2D Ñ€Ğ°Ğ½Ğ½ĞµÑ€)
?route=admin                # ĞĞ´Ğ¼Ğ¸Ğ½-Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ
?route=startup-payout       # Ğ¡Ñ‚Ğ°Ñ€Ñ‚Ğ¾Ğ²Ñ‹Ğµ Ğ²Ñ‹Ğ¿Ğ»Ğ°Ñ‚Ñ‹
?route=news                 # ĞĞ¾Ğ²Ğ¾ÑÑ‚Ğ¸
?route=content              # Stories ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚
```

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹**:
- âœ… **Ğ§Ğ˜Ğ¢ĞĞ•Ğ¢**: `couriers`, `withdrawal_requests`, `game_scores`, `admins`, `activity_log`
- âœ… **ĞŸĞ˜Ğ¨Ğ•Ğ¢**: `couriers`, `withdrawal_requests`, `game_scores`, `activity_log`, `courier_earnings_snapshot`

---

### 2ï¸âƒ£ **backend/messenger-api/index.py** - ĞœĞ•Ğ¡Ğ¡Ğ•ĞĞ”Ğ–Ğ•Ğ Ğ«
**URL**: `https://functions.poehali.dev/b0d34a9d-f92c-4526-bfcf-c6dfa76dfb15`

**Actions**:
```python
?action=generate_code         # Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ ĞºĞ¾Ğ´Ğ° Ğ¿Ñ€Ğ¸Ğ²ÑĞ·ĞºĞ¸
?action=verify_code           # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ¾Ğ´Ğ° Ğ¿Ñ€Ğ¸Ğ²ÑĞ·ĞºĞ¸
?action=telegram_webapp_auth  # ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· Telegram Web App
?action=status                # Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹
?action=unlink                # ĞÑ‚Ğ²ÑĞ·ĞºĞ° Ğ¼ĞµÑÑĞµĞ½Ğ´Ğ¶ĞµÑ€Ğ°
```

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹**:
- âœ… **Ğ§Ğ˜Ğ¢ĞĞ•Ğ¢/ĞŸĞ˜Ğ¨Ğ•Ğ¢**: `messenger_connections`, `messenger_link_codes`, `bot_activity_log`, `couriers`

---

### 3ï¸âƒ£ **backend/telegram-bot/index.py** - TELEGRAM Ğ‘ĞĞ¢
**URL**: `https://functions.poehali.dev/4e3e64ea-65e0-4f91-9e11-9d9638d55dd9`

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»**:
- ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹: `/start`, `/link`, `/stats`, `/games`, `/withdrawals`
- ĞšĞ½Ğ¾Ğ¿ĞºĞ¸: ğŸ® Ğ˜Ğ³Ñ€Ğ°Ñ‚ÑŒ, ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°, ğŸ’° Ğ’Ñ‹Ğ¿Ğ»Ğ°Ñ‚Ñ‹
- Web App: ĞÑ‚ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ Ğ¸Ğ³Ñ€ Ñ‡ĞµÑ€ĞµĞ· Telegram

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹**:
- âœ… **Ğ§Ğ˜Ğ¢ĞĞ•Ğ¢**: `messenger_connections`, `couriers`, `courier_earnings_snapshot`, `bot_content`
- âœ… **ĞŸĞ˜Ğ¨Ğ•Ğ¢**: `messenger_connections`, `bot_activity_log`

---

### 4ï¸âƒ£ **backend/courier-game/index.py** - Ğ˜Ğ“Ğ Ğ "Ğ“ĞĞ ĞĞ” Ğ’ Ğ”Ğ’Ğ˜Ğ–Ğ•ĞĞ˜Ğ˜"
**URL**: `https://functions.poehali.dev/5e0b16d4-2a3a-46ee-a167-0b6712ac503e`

**Actions**:
```python
?action=save_progress  # Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑĞ°
?action=get_progress   # ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑĞ°
?action=leaderboard    # Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ğ»Ğ¸Ğ´ĞµÑ€Ğ¾Ğ²
```

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹**:
- âœ… **Ğ§Ğ˜Ğ¢ĞĞ•Ğ¢/ĞŸĞ˜Ğ¨Ğ•Ğ¢**: `courier_game_progress`, `leaderboard`

---

### 5ï¸âƒ£ **backend/admin-panel/index.py** - ĞĞ”ĞœĞ˜ĞĞšĞ
**URL**: `https://functions.poehali.dev/f3c62de9-e0ca-4b73-8983-f15a4fa651b5`

**Routes**:
```python
?route=couriers&action=list    # Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº ĞºÑƒÑ€ÑŒĞµÑ€Ğ¾Ğ²
?route=couriers&action=update  # ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºÑƒÑ€ÑŒĞµÑ€Ğ°
?route=couriers&action=delete  # Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ ĞºÑƒÑ€ÑŒĞµÑ€Ğ°
?route=referrals&action=list   # Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»Ğ¾Ğ²
?route=referrals&action=stats  # Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»Ğ¾Ğ²
```

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹**:
- âœ… **Ğ§Ğ˜Ğ¢ĞĞ•Ğ¢**: `couriers`, `referrals` âš ï¸, `courier_earnings_snapshot`
- âœ… **ĞŸĞ˜Ğ¨Ğ•Ğ¢**: `couriers` (UPDATE, DELETE)

âš ï¸ **ĞŸĞ ĞĞ‘Ğ›Ğ•ĞœĞ**: Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ ÑƒÑÑ‚Ğ°Ñ€ĞµĞ²ÑˆÑƒÑ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ `referrals`!

---

### 6ï¸âƒ£ **backend/admin-finances/index.py** - ĞĞ”ĞœĞ˜Ğ Ğ¤Ğ˜ĞĞĞĞ¡Ğ«
**URL**: `https://functions.poehali.dev/8e37c21f-d68d-4e20-9d9c-60f5c50cf2e5`

**Actions**:
```python
?action=stats             # Ğ¤Ğ¸Ğ½Ğ°Ğ½ÑĞ¾Ğ²Ğ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°
?action=payments          # Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ²Ñ‹Ğ¿Ğ»Ğ°Ñ‚
?action=update_ad_spend   # ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ€ĞµĞºĞ»Ğ°Ğ¼Ğ½Ñ‹Ñ… Ñ€Ğ°ÑÑ…Ğ¾Ğ´Ğ¾Ğ²
```

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹**:
- âœ… **Ğ§Ğ˜Ğ¢ĞĞ•Ğ¢**: `withdrawal_requests`, `couriers`, `admin_ad_spend_history`, `referrals` âš ï¸
- âœ… **ĞŸĞ˜Ğ¨Ğ•Ğ¢**: `admin_ad_spend_history`

---

## ğŸ“ Ğ¢ĞĞ‘Ğ›Ğ˜Ğ¦Ğ« Ğ‘ĞĞ—Ğ« Ğ”ĞĞĞĞ«Ğ¥

### âœ… ĞĞšĞ¢Ğ˜Ğ’ĞĞ«Ğ• Ğ˜ ĞĞ£Ğ–ĞĞ«Ğ•

#### **couriers** (44 Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸) 
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ğ²ÑĞµÑ… ĞºÑƒÑ€ÑŒĞµÑ€Ğ¾Ğ².

```sql
ĞŸĞ¾Ğ»Ñ:
- id                      INT PRIMARY KEY
- full_name               VARCHAR
- email                   VARCHAR
- phone                   VARCHAR
- city                    VARCHAR
- referral_code           VARCHAR UNIQUE (Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¸Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ)
- invited_by_user_id      INT (FK â†’ couriers.id) âš ï¸ Ğ’ĞĞ–ĞĞ!
- total_orders            INT
- oauth_provider          VARCHAR ('yandex' | 'telegram')
- oauth_id                VARCHAR
- created_at              TIMESTAMP
- is_active               BOOLEAN
- avatar_url              VARCHAR
- sbp_phone               VARCHAR (Ğ´Ğ»Ñ Ğ²Ñ‹Ğ¿Ğ»Ğ°Ñ‚)
- sbp_bank_name           VARCHAR
- external_id             VARCHAR (ID Ğ¸Ğ· Ğ¯Ğ½Ğ´ĞµĞºÑ.Ğ•Ğ´Ğ°)
```

**Ğ¡Ğ²ÑĞ·Ğ¸**:
- `invited_by_user_id` â†’ Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° (ĞºÑ‚Ğ¾ Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸Ğ»)
- `id` â†’ Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ²Ğ¾ Ğ²ÑĞµÑ… Ğ´Ñ€ÑƒĞ³Ğ¸Ñ… Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ°Ñ…

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°**: âŒ Ğ’ Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞµ ĞºÑƒÑ€ÑŒĞµÑ€Ñ‹ Ğ½Ğµ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°ÑÑ‚ÑÑ!

---

#### **messenger_connections** (1 Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ)
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ¡Ğ²ÑĞ·ÑŒ ĞºÑƒÑ€ÑŒĞµÑ€ â†” Telegram/WhatsApp.

```sql
ĞŸĞ¾Ğ»Ñ:
- id                      INT PRIMARY KEY
- courier_id              INT (FK â†’ couriers.id)
- messenger_type          VARCHAR ('telegram' | 'whatsapp')
- messenger_user_id       VARCHAR
- messenger_username      VARCHAR
- is_verified             BOOLEAN
- created_at              TIMESTAMP
- last_interaction_at     TIMESTAMP
- blocked_at              TIMESTAMP
```

**Ğ¡Ğ²ÑĞ·Ğ¸**:
- `courier_id` â†’ `couriers.id`

---

#### **messenger_link_codes** (20 Ğ·Ğ°Ğ¿Ğ¸ÑĞµĞ¹)
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ ĞºĞ¾Ğ´Ñ‹ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¸Ğ²ÑĞ·ĞºĞ¸ Ğ¼ĞµÑÑĞµĞ½Ğ´Ğ¶ĞµÑ€Ğ¾Ğ².

```sql
ĞŸĞ¾Ğ»Ñ:
- id                INT PRIMARY KEY
- courier_id        INT (FK â†’ couriers.id)
- code              VARCHAR(6) (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, "ABC123")
- expires_at        TIMESTAMP
- is_used           BOOLEAN
- used_at           TIMESTAMP
- created_at        TIMESTAMP
```

**Ğ–Ğ¸Ğ·Ğ½ĞµĞ½Ğ½Ñ‹Ğ¹ Ñ†Ğ¸ĞºĞ»**:
1. ĞšÑƒÑ€ÑŒĞµÑ€ Ğ½Ğ°Ğ¶Ğ¸Ğ¼Ğ°ĞµÑ‚ "ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Telegram"
2. Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ ĞºĞ¾Ğ´ (ÑÑ€Ğ¾Ğº Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ 10 Ğ¼Ğ¸Ğ½ÑƒÑ‚)
3. ĞšÑƒÑ€ÑŒĞµÑ€ Ğ²Ğ²Ğ¾Ğ´Ğ¸Ñ‚ ĞºĞ¾Ğ´ Ğ² Ğ±Ğ¾Ñ‚Ğµ
4. ĞšĞ¾Ğ´ Ğ¿Ğ¾Ğ¼ĞµÑ‡Ğ°ĞµÑ‚ÑÑ `is_used = true`

---

#### **withdrawal_requests**
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ—Ğ°ÑĞ²ĞºĞ¸ Ğ½Ğ° Ğ²Ñ‹Ğ¿Ğ»Ğ°Ñ‚Ñƒ Ğ±Ğ¾Ğ½ÑƒÑĞ¾Ğ².

```sql
ĞŸĞ¾Ğ»Ñ:
- id                INT PRIMARY KEY
- courier_id        INT (FK â†’ couriers.id)
- amount            DECIMAL
- sbp_phone         VARCHAR
- sbp_bank_name     VARCHAR
- status            VARCHAR ('pending' | 'approved' | 'rejected' | 'paid')
- admin_comment     TEXT
- created_at        TIMESTAMP
- processed_at      TIMESTAMP
- paid_at           TIMESTAMP
```

**ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…**:
```
1. ĞšÑƒÑ€ÑŒĞµÑ€ â†’ "Ğ’Ñ‹Ğ²ĞµÑÑ‚Ğ¸ Ğ´ĞµĞ½ÑŒĞ³Ğ¸"
2. INSERT INTO withdrawal_requests (status='pending')
3. ĞĞ´Ğ¼Ğ¸Ğ½ â†’ ĞĞ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚
4. UPDATE status='approved'/'rejected'
5. ĞŸĞ¾ÑĞ»Ğµ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñ‹ â†’ UPDATE status='paid', paid_at=NOW()
6. Ğ•ÑĞ»Ğ¸ Telegram Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½ â†’ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ
```

---

#### **game_scores** (24 Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸) 
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¸Ğ³Ñ€Ñ‹ "ĞŸÑ€Ğ¸ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ ĞºÑƒÑ€ÑŒĞµÑ€Ğ°" (HTML5 Ñ€Ğ°Ğ½Ğ½ĞµÑ€).

```sql
ĞŸĞ¾Ğ»Ñ:
- id                INT PRIMARY KEY
- courier_id        INT (FK â†’ couriers.id)
- score             INT
- game_time         INT (ÑĞµĞºÑƒĞ½Ğ´Ñ‹)
- created_at        TIMESTAMP
```

**âš ï¸ Ğ—ĞĞ”ĞĞ§Ğ**: ĞĞ±Ğ½ÑƒĞ»Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹!

---

#### **courier_game_progress** (1 Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ)
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: ĞŸÑ€Ğ¾Ğ³Ñ€ĞµÑÑ Ğ² Ğ¸Ğ³Ñ€Ğµ "ĞšÑƒÑ€ÑŒĞµÑ€: Ğ“Ğ¾Ñ€Ğ¾Ğ´ Ğ² Ğ´Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ğ¸" (3D ÑĞ¸Ğ¼ÑƒĞ»ÑÑ‚Ğ¾Ñ€).

```sql
ĞŸĞ¾Ğ»Ñ:
- user_id           INT PRIMARY KEY (FK â†’ couriers.id)
- level             INT
- best_score        INT
- total_orders      INT
- transport         VARCHAR ('walk' | 'bike' | 'moped' | 'car')
- total_earnings    DECIMAL
- upgrades          JSON
- achievements      JSON
- updated_at        TIMESTAMP
```

**âš ï¸ Ğ—ĞĞ”ĞĞ§Ğ**: ĞĞ±Ğ½ÑƒĞ»Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹!

---

#### **leaderboard** (3 Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸)
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ğ»Ğ¸Ğ´ĞµÑ€Ğ¾Ğ² Ğ´Ğ»Ñ 3D ÑĞ¸Ğ¼ÑƒĞ»ÑÑ‚Ğ¾Ñ€Ğ°.

```sql
ĞŸĞ¾Ğ»Ñ:
- user_id           INT PRIMARY KEY
- username          VARCHAR
- level             INT
- best_score        INT
- total_orders      INT
- transport         VARCHAR
- total_earnings    DECIMAL
- last_updated      TIMESTAMP
```

**âš ï¸ Ğ—ĞĞ”ĞĞ§Ğ**: ĞĞ±Ğ½ÑƒĞ»Ğ¸Ñ‚ÑŒ!

---

#### **courier_earnings_snapshot** (3 Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸)
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ¡Ğ½ĞµĞ¿ÑˆĞ¾Ñ‚ Ñ„Ğ¸Ğ½Ğ°Ğ½ÑĞ¾Ğ² ĞºÑƒÑ€ÑŒĞµÑ€Ğ°.

```sql
ĞŸĞ¾Ğ»Ñ:
- courier_id                  INT PRIMARY KEY
- total_bonus_earned          DECIMAL (Ğ¾Ğ±Ñ‰Ğ¸Ğ¹ Ğ±Ğ¾Ğ½ÑƒÑ)
- total_bonus_paid            DECIMAL (Ğ²Ñ‹Ğ¿Ğ»Ğ°Ñ‡ĞµĞ½Ğ¾)
- pending_bonus               DECIMAL (Ğ¾Ğ¶Ğ¸Ğ´Ğ°ĞµÑ‚ Ğ²Ñ‹Ğ¿Ğ»Ğ°Ñ‚Ñ‹)
- self_bonus_amount           DECIMAL (ÑĞ²Ğ¾Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚Ğ¾Ğ²Ñ‹Ğ¹ Ğ±Ğ¾Ğ½ÑƒÑ)
- referral_income             DECIMAL (Ğ´Ğ¾Ñ…Ğ¾Ğ´ Ñ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»Ğ¾Ğ²)
- self_bonus_paid             BOOLEAN (Ğ²Ñ‹Ğ¿Ğ»Ğ°Ñ‡ĞµĞ½ Ğ»Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‚Ğ¾Ğ²Ñ‹Ğ¹)
- self_orders_count           INT
- self_bonus_completed        BOOLEAN
- available_for_withdrawal    DECIMAL (Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ Ğº Ğ²Ñ‹Ğ²Ğ¾Ğ´Ñƒ)
- total_paid                  DECIMAL (Ğ²ÑĞµĞ³Ğ¾ Ğ²Ñ‹Ğ¿Ğ»Ğ°Ñ‡ĞµĞ½Ğ¾)
- last_updated                TIMESTAMP
```

**âš ï¸ Ğ—ĞĞ”ĞĞ§Ğ**: ĞĞ±Ğ½ÑƒĞ»Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ğ±Ğ¾Ğ½ÑƒÑÑ‹!

---

#### **bot_activity_log** (111 Ğ·Ğ°Ğ¿Ğ¸ÑĞµĞ¹)
**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ**: Ğ›Ğ¾Ğ³Ğ¸ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ Telegram/WhatsApp Ğ±Ğ¾Ñ‚Ğ¾Ğ².

```sql
ĞŸĞ¾Ğ»Ñ:
- id                INT PRIMARY KEY
- courier_id        INT (FK â†’ couriers.id)
- messenger_type    VARCHAR ('telegram' | 'whatsapp')
- action            VARCHAR ('link_success', 'message_sent', etc.)
- details           JSON
- created_at        TIMESTAMP
```

---

### âŒ ĞŸĞ ĞĞ‘Ğ›Ğ•ĞœĞĞ«Ğ• Ğ¢ĞĞ‘Ğ›Ğ˜Ğ¦Ğ«

#### **referrals** âš ï¸ Ğ£Ğ¡Ğ¢ĞĞ Ğ•Ğ’Ğ¨ĞĞ¯!
**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ**: âŒ ĞĞ• Ğ˜Ğ¡ĞŸĞĞ›Ğ¬Ğ—Ğ£Ğ•Ğ¢Ğ¡Ğ¯ Ğ¡ 2024 Ğ“ĞĞ”Ğ!

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°**:
- Backend Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ `couriers.invited_by_user_id` Ğ´Ğ»Ñ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»Ğ¾Ğ²
- Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° `referrals` Ğ±Ğ¾Ğ»ÑŒÑˆĞµ ĞĞ• Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ÑÑ
- ĞĞ´Ğ¼Ğ¸Ğ½ĞºĞ° Ğ¿Ñ‹Ñ‚Ğ°ĞµÑ‚ÑÑ Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ğ¸Ğ· `referrals` â†’ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹ ÑĞ¿Ğ¸ÑĞ¾Ğº
- Ğ­Ñ‚Ğ¾ Ğ¾Ğ±ÑŠÑÑĞ½ÑĞµÑ‚, Ğ¿Ğ¾Ñ‡ĞµĞ¼Ñƒ ĞºÑƒÑ€ÑŒĞµÑ€Ñ‹ Ğ½Ğµ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°ÑÑ‚ÑÑ!

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ**:
1. Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ `referrals`
2. ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ `backend/admin-panel/index.py` â†’ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ `couriers.invited_by_user_id`
3. ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ `backend/admin-finances/index.py` â†’ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ `couriers.invited_by_user_id`

---

#### **users** âš ï¸ Ğ”Ğ£Ğ‘Ğ›Ğ˜ĞšĞĞ¢
**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ**: âŒ ĞĞ• Ğ˜Ğ¡ĞŸĞĞ›Ğ¬Ğ—Ğ£Ğ•Ğ¢Ğ¡Ğ¯!

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°**: Ğ•ÑÑ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ `couriers`. Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° `users` Ğ½Ğµ Ğ½ÑƒĞ¶Ğ½Ğ°.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ**: Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ.

---

#### **payout_requests** âš ï¸ Ğ’ĞĞ—ĞœĞĞ–ĞĞ«Ğ™ Ğ”Ğ£Ğ‘Ğ›Ğ˜ĞšĞĞ¢
**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ**: â“ ĞĞ•Ğ¯Ğ¡ĞĞ

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°**: ĞŸĞ¾Ñ…Ğ¾Ğ¶Ğ° Ğ½Ğ° `withdrawal_requests`. ĞÑƒĞ¶Ğ½Ğ¾ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ, Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ»Ğ¸.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ**: Ğ•ÑĞ»Ğ¸ Ğ½Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ â€” ÑƒĞ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ.

---

## ğŸ”„ ĞŸĞĞ¢ĞĞšĞ˜ Ğ”ĞĞĞĞ«Ğ¥

### 1. Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ ĞºÑƒÑ€ÑŒĞµÑ€Ğ°
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ    â”‚
â”‚  Ğ½Ğ°Ğ¶Ğ¸Ğ¼Ğ°ĞµÑ‚        â”‚
â”‚  "Ğ’Ğ¾Ğ¹Ñ‚Ğ¸ Ñ‡ĞµÑ€ĞµĞ·    â”‚
â”‚  Ğ¯Ğ½Ğ´ĞµĞºÑ"         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OAuth redirect Ğ½Ğ° Yandex  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  backend/api/index.py                  â”‚
â”‚  ?route=auth&action=oauth_callback     â”‚
â”‚                                        â”‚
â”‚  1. ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¾ĞºĞµĞ½Ğ° Ğ¾Ñ‚ Yandex        â”‚
â”‚  2. ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ     â”‚
â”‚  3. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ref ĞºĞ¾Ğ´Ğ° Ğ² Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ°Ñ…    â”‚
â”‚  4. INSERT INTO couriers               â”‚
â”‚     - Ğ•ÑĞ»Ğ¸ ref ĞºĞ¾Ğ´ â†’ invited_by_user_idâ”‚
â”‚  5. Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ JWT Ñ‚Ğ¾ĞºĞµĞ½Ğ°              â”‚
â”‚  6. Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ Ñ‚Ğ¾ĞºĞµĞ½Ğ° Ñ„Ñ€Ğ¾Ğ½Ñ‚ĞµĞ½Ğ´Ñƒ          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  React           â”‚
â”‚  AuthContext     â”‚
â”‚  ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚       â”‚
â”‚  Ñ‚Ğ¾ĞºĞµĞ½ Ğ¸ user    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. ĞŸÑ€Ğ¸Ğ²ÑĞ·ĞºĞ° Telegram
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ĞšÑƒÑ€ÑŒĞµÑ€ Ğ² Ğ›Ğš       â”‚
â”‚  Ğ½Ğ°Ğ¶Ğ¸Ğ¼Ğ°ĞµÑ‚          â”‚
â”‚  "ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ       â”‚
â”‚  Telegram"         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  backend/messenger-api/index.py        â”‚
â”‚  ?action=generate_code                 â”‚
â”‚                                        â”‚
â”‚  1. INSERT INTO messenger_link_codes   â”‚
â”‚     - ĞºĞ¾Ğ´ ABC123                       â”‚
â”‚     - expires_at = NOW() + 10 Ğ¼Ğ¸Ğ½     â”‚
â”‚  2. Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ ĞºĞ¾Ğ´Ğ° Ñ„Ñ€Ğ¾Ğ½Ñ‚ĞµĞ½Ğ´Ñƒ            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ¤Ñ€Ğ¾Ğ½Ñ‚ĞµĞ½Ğ´ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚:        â”‚
â”‚  "Ğ’Ğ°Ñˆ ĞºĞ¾Ğ´: ABC123"           â”‚
â”‚  "ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ /start Ğ±Ğ¾Ñ‚Ñƒ"     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ĞšÑƒÑ€ÑŒĞµÑ€ â†’ Telegram Ğ±Ğ¾Ñ‚       â”‚
â”‚  /start                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  backend/telegram-bot/index.py         â”‚
â”‚                                        â”‚
â”‚  1. Ğ‘Ğ¾Ñ‚ Ğ¿Ñ€Ğ¾ÑĞ¸Ñ‚ Ğ²Ğ²ĞµÑÑ‚Ğ¸ ĞºĞ¾Ğ´             â”‚
â”‚  2. ĞšÑƒÑ€ÑŒĞµÑ€ Ğ²Ğ²Ğ¾Ğ´Ğ¸Ñ‚ "ABC123"            â”‚
â”‚  3. POST Ğº messenger-api               â”‚
â”‚     ?action=verify_code                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  backend/messenger-api/index.py        â”‚
â”‚  ?action=verify_code                   â”‚
â”‚                                        â”‚
â”‚  1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ¾Ğ´Ğ° Ğ² link_codes        â”‚
â”‚  2. INSERT INTO messenger_connections  â”‚
â”‚     - courier_id                       â”‚
â”‚     - messenger_user_id (Telegram ID)  â”‚
â”‚     - is_verified = true               â”‚
â”‚  3. UPDATE link_codes SET is_used=true â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ‘Ğ¾Ñ‚ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚:             â”‚
â”‚  "âœ… ĞŸÑ€Ğ¸Ğ²ÑĞ·ĞºĞ° ÑƒÑĞ¿ĞµÑˆĞ½Ğ°!"      â”‚
â”‚                              â”‚
â”‚  ĞœĞµĞ½Ñ:                       â”‚
â”‚  ğŸ® Ğ˜Ğ³Ñ€Ğ°Ñ‚ÑŒ Ğ² Ğ¸Ğ³Ñ€Ñ‹            â”‚
â”‚  ğŸ“Š ĞœĞ¾Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°           â”‚
â”‚  ğŸ’° Ğ’Ñ‹Ğ¿Ğ»Ğ°Ñ‚Ñ‹                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Ğ—Ğ°ÑĞ²ĞºĞ° Ğ½Ğ° Ğ²Ñ‹Ğ¿Ğ»Ğ°Ñ‚Ñƒ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ĞšÑƒÑ€ÑŒĞµÑ€ Ğ² Ğ›Ğš       â”‚
â”‚  "Ğ’Ñ‹Ğ²ĞµÑÑ‚Ğ¸ Ğ´ĞµĞ½ÑŒĞ³Ğ¸"  â”‚
â”‚  Ğ’Ğ²Ğ¾Ğ´Ğ¸Ñ‚ ÑÑƒĞ¼Ğ¼Ñƒ      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  backend/api/index.py                  â”‚
â”‚  ?route=withdrawal&action=create       â”‚
â”‚                                        â”‚
â”‚  1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° available_for_withdrawal â”‚
â”‚  2. INSERT INTO withdrawal_requests    â”‚
â”‚     - amount                           â”‚
â”‚     - sbp_phone                        â”‚
â”‚     - status='pending'                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ĞĞ´Ğ¼Ğ¸Ğ½ Ğ² Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞµ Ğ²Ğ¸Ğ´Ğ¸Ñ‚       â”‚
â”‚  Ğ½Ğ¾Ğ²ÑƒÑ Ğ·Ğ°ÑĞ²ĞºÑƒ                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ĞĞ´Ğ¼Ğ¸Ğ½ Ğ½Ğ°Ğ¶Ğ¸Ğ¼Ğ°ĞµÑ‚ "ĞĞ´Ğ¾Ğ±Ñ€Ğ¸Ñ‚ÑŒ"             â”‚
â”‚                                        â”‚
â”‚  backend/api/index.py                  â”‚
â”‚  ?route=withdrawal&action=update_statusâ”‚
â”‚                                        â”‚
â”‚  1. UPDATE withdrawal_requests         â”‚
â”‚     SET status='approved'              â”‚
â”‚  2. Ğ•ÑĞ»Ğ¸ Telegram Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½:           â”‚
â”‚     - ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· Ğ±Ğ¾Ñ‚Ğ°  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. Ğ˜Ğ³Ñ€Ğ° HTML5 Ñ€Ğ°Ğ½Ğ½ĞµÑ€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ĞšÑƒÑ€ÑŒĞµÑ€ Ğ¸Ğ³Ñ€Ğ°ĞµÑ‚      â”‚
â”‚  /game.html         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JavaScript Ğ² game.html                â”‚
â”‚                                        â”‚
â”‚  1. ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ·                  â”‚
â”‚     messenger-api (Telegram Web App)   â”‚
â”‚  2. Ğ˜Ğ³Ñ€Ğ° Ğ·Ğ°ĞºĞ¾Ğ½Ñ‡ĞµĞ½Ğ°                     â”‚
â”‚  3. fetch Ğº backend/courier-game       â”‚
â”‚     ?action=save_progress              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  backend/courier-game/index.py         â”‚
â”‚  ?action=save_progress                 â”‚
â”‚                                        â”‚
â”‚  1. INSERT/UPDATE courier_game_progressâ”‚
â”‚  2. UPDATE leaderboard                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§Ğ•Ğ¡ĞšĞ˜Ğ• ĞŸĞ ĞĞ‘Ğ›Ğ•ĞœĞ«

### âŒ ĞŸĞ ĞĞ‘Ğ›Ğ•ĞœĞ 1: ĞšÑƒÑ€ÑŒĞµÑ€Ñ‹ Ğ½Ğµ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°ÑÑ‚ÑÑ Ğ² Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞµ
**Ğ›Ğ¾ĞºĞ°Ñ†Ğ¸Ñ**: 
- Frontend: `src/components/admin/UnifiedCouriersTab.tsx`
- Backend: `backend/admin-panel/index.py`

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°**: 
1. Backend Ñ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ Ğ¸Ğ· ÑƒÑÑ‚Ğ°Ñ€ĞµĞ²ÑˆĞµĞ¹ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ `referrals`
2. Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ğ¿ÑƒÑÑ‚Ğ°Ñ â†’ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ []
3. Frontend Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹ ÑĞ¿Ğ¸ÑĞ¾Ğº

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ**:
```python
# Ğ’ backend/admin-panel/index.py
# Ğ‘Ğ«Ğ›Ğ:
SELECT * FROM referrals WHERE referrer_id = %s

# Ğ¡Ğ¢ĞĞ›Ğ:
SELECT * FROM couriers WHERE invited_by_user_id = %s
```

---

### âŒ ĞŸĞ ĞĞ‘Ğ›Ğ•ĞœĞ 2: Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°**: Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° `referrals` Ğ½Ğµ Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ÑÑ Ñ 2024 Ğ³Ğ¾Ğ´Ğ°

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ**:
1. Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ `referrals`
2. ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ backend Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ½Ğ° `couriers.invited_by_user_id`
3. ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ SQL Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ² Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞµ

---

### âŒ ĞŸĞ ĞĞ‘Ğ›Ğ•ĞœĞ 3: Ğ”ÑƒĞ±Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†
**Ğ§Ñ‚Ğ¾ ÑƒĞ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ**:
- `referrals` (Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ `couriers.invited_by_user_id`)
- `users` (Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ `couriers`)
- `payout_requests` (ĞµÑĞ»Ğ¸ ÑÑ‚Ğ¾ Ğ´ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚ `withdrawal_requests`)

---

## âœ… Ğ—ĞĞ”ĞĞ§Ğ˜ ĞĞ ĞĞ‘ĞĞ£Ğ›Ğ•ĞĞ˜Ğ•

### Ğ˜Ğ³Ñ€Ğ¾Ğ²Ñ‹Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹:
```sql
-- ĞĞ±Ğ½ÑƒĞ»Ğ¸Ñ‚ÑŒ HTML5 Ñ€Ğ°Ğ½Ğ½ĞµÑ€
DELETE FROM t_p25272970_courier_button_site.game_scores;

-- ĞĞ±Ğ½ÑƒĞ»Ğ¸Ñ‚ÑŒ 3D ÑĞ¸Ğ¼ÑƒĞ»ÑÑ‚Ğ¾Ñ€
DELETE FROM t_p25272970_courier_button_site.courier_game_progress;
DELETE FROM t_p25272970_courier_button_site.leaderboard;
```

### Ğ¤Ğ¸Ğ½Ğ°Ğ½ÑÑ‹:
```sql
-- ĞĞ±Ğ½ÑƒĞ»Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ğ±Ğ¾Ğ½ÑƒÑÑ‹
UPDATE t_p25272970_courier_button_site.courier_earnings_snapshot
SET 
  total_bonus_earned = 0,
  total_bonus_paid = 0,
  pending_bonus = 0,
  self_bonus_amount = 0,
  referral_income = 0,
  self_bonus_paid = false,
  self_orders_count = 0,
  self_bonus_completed = false,
  available_for_withdrawal = 0,
  total_paid = 0;

-- ĞĞ±Ğ½ÑƒĞ»Ğ¸Ñ‚ÑŒ Ğ·Ğ°ÑĞ²ĞºĞ¸ Ğ½Ğ° Ğ²Ñ‹Ğ¿Ğ»Ğ°Ñ‚Ñ‹
DELETE FROM t_p25272970_courier_button_site.withdrawal_requests;
```

---

## ğŸ“ Ğ Ğ•ĞšĞĞœĞ•ĞĞ”ĞĞ¦Ğ˜Ğ˜

### âœ… ĞĞ¡Ğ¢ĞĞ’Ğ˜Ğ¢Ğ¬:
- `couriers` â­
- `messenger_connections`
- `messenger_link_codes`
- `withdrawal_requests`
- `game_scores`
- `courier_game_progress`
- `leaderboard`
- `courier_earnings_snapshot`
- `bot_activity_log`
- `admin_ad_spend_history`
- `activity_log`

### âŒ Ğ£Ğ”ĞĞ›Ğ˜Ğ¢Ğ¬:
- `referrals` (ÑƒÑÑ‚Ğ°Ñ€ĞµĞ²ÑˆĞ°Ñ)
- `users` (Ğ´ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚ couriers)
- `payout_requests` (ĞµÑĞ»Ğ¸ Ğ´ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚)

### ğŸ”§ Ğ˜Ğ¡ĞŸĞ ĞĞ’Ğ˜Ğ¢Ğ¬:
1. **backend/admin-panel/index.py** â†’ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ½Ğ° `couriers.invited_by_user_id`
2. **backend/admin-finances/index.py** â†’ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ½Ğ° `couriers.invited_by_user_id`
3. **ĞĞ±Ğ½ÑƒĞ»Ğ¸Ñ‚ÑŒ** â†’ game_scores, courier_game_progress, leaderboard, courier_earnings_snapshot, withdrawal_requests

---

## ğŸ¯ ĞŸĞ›ĞĞ Ğ”Ğ•Ğ™Ğ¡Ğ¢Ğ’Ğ˜Ğ™

1. âœ… **ĞĞ±Ğ½ÑƒĞ»Ğ¸Ñ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ** (ÑĞµĞ¹Ñ‡Ğ°Ñ)
2. ğŸ” **ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ¿Ñ€Ğ¸Ñ‡Ğ¸Ğ½Ñƒ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ñ Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞ¾Ğ¹** (Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ backend/admin-panel)
3. ğŸ—‘ï¸ **Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ referrals** (Ğ¿Ğ¾ÑĞ»Ğµ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²)
4. ğŸ”„ **ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ backend** (Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ couriers.invited_by_user_id)
5. âœ… **ĞŸÑ€Ğ¾Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ** (Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞ°, Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»Ñ‹, Ğ²Ñ‹Ğ¿Ğ»Ğ°Ñ‚Ñ‹)

---

**ĞšĞ¾Ğ½ĞµÑ† Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°**
